DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Creuna.Episerver.RedirectHandler.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201703072211595_Initial'
BEGIN
    CREATE TABLE [dbo].[CustomRedirects] (
        [Id] [uniqueidentifier] NOT NULL DEFAULT newsequentialid(),
        [NewUrl] [nvarchar](max),
        [OldUrl] [nvarchar](max) NOT NULL,
        [AppendMatchToNewUrl] [bit] NOT NULL,
        [ExactMatch] [bit] NOT NULL,
        [IncludeQueryString] [bit] NOT NULL,
        [State] [int] NOT NULL,
        [NotfoundErrorCount] [int] NOT NULL,
        CONSTRAINT [PK_dbo.CustomRedirects] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201703072211595_Initial', N'Creuna.Episerver.RedirectHandler.Migrations.Configuration',  0x1F8B0800000000000400CD58CD6EE3460CBE17E83B083AB540D64A9C4B1BC8BBC83A766A746DA751B2F7B1442B838E66B4F393DACFD6431FA9AF50EAFFD7B19CA445E18B351A7E243F72488EFEFEF32FF7D32E62D6334845059FD817A373DB02EE8B80F270621BBDFDF093FDE9E3F7DFB9B320DA595F8B7D97C93E94E46A623F691D5F398EF29F20226A14515F0A25B67AE48BC8218170C6E7E73F3B17170E20848D5896E5DE1BAE6904E9033E4E05F721D686B0A50880A97C1DDF7829AAB52211A898F830B1A7120C27A3594C1548347C740F0195E0EB5F080F183E4F8584D10DD1C4B6AE192568A1076C6B5B8473A18946FBAF1E15785A0A1E7A312E10F6B08F01F76D095390FB75556D1FEAE2F93871D1A9040B28DF282DA213012F2E73CE9CB6F8AB98B74B4E91D519B2AFF789D729B3486AAAA260D2B6DA2AAFA64C26DB87D2DFC453ADE733EB18CA59996A9869C90F450CD346C28483D192B033EBCE6C18F57F85FD83F81DF8841BC6EA4EA29BF8AEB1804B7752C420F5FE1EB6B9EB8BC0B69CA69CD3162CC56A32191DB786E2FF15EA261B06650AD598F33412720B1C24D110DC11AD41F20402D2207494B754ADE08F47C90A7598B578306D6B49765F8087FA6962E35FDB9AD31D04C54A6EC323A7788E51484B03C7D4AC59F03E6A3A54BCACF73A8E81074BA2FDA707D1F4F5B3100C083F1972B623BE4E11DF8AB4E03E3301FC6640EE0B4ADE86E8615240C93296A5D12DE87CF144A895D05B6178309352C829FED305EE82EBCBF1113CD7A96A40B33298A856172AEB166ACE485815C9B75688A44097CEFF7B0501D33300C9F618BB3A394D6697106D40162122CF8047FA2B61069FCE3B61686E3661082A2BCAB9C4C5CB128B90A3FB958271372E5904BAF51ABBA426949750CDA29ABC855D5FEDC66E970747E5A7B4695F86EE81EEC555B655A54A9EB4ED76D19759A5B5553377B26E5E747DE740DB7797248E3160B531205FB1BC7C06F8E09DDE04A30CC3F1554F2F2CAD2D3561D92621B4DEA26AB4744EA5D249026F487214A641D4DDD61B9B03BC173AFBE96FB7B02A1A855CF23F971D7EF65A316C69A9389F230D11F6AA9411286DEECC0C1D80747A238CC89EE63915CC44FC50037E49BAE8117584626D384AD1EEEA28C5DA7094DEE65587ECDD301CBFDEC9EAB0F5F5E1687DDDAC11879EF7C3D1F3365107CC974E886D4F4B6BC4B9E77D17DD755A99DB3E404EE704B5C6BFF6C17CA9BAB5B794DACB2AD7AA666E5E5906DC74DAA526DB625B48DB330D9232E3ED9586283BD0DE3736651412528A0D4BC2E916FB53D6106DBC548C5B97A2FFCF05C5512A6027DD52FEF361DF70FACD004D27F72D05695B4787FB5387BAC604CC9F89F49F88FC2122BB1FEB58A74FF407A1DE3AA56FA87E8709FD352887A7F3D7A0352673CA4F07383C8F1F473B3C8DF7CE7D9D11E494796EC03897D599891D6C04FA9059DD190A5F39F375AB9FEBD4BF06B937A068584124DF86386AC4B25281167B167C2B8A30A0BF758B8A2DAD282D41930069BB967884310BF1B50F4AA5C9934FE4339CD683055F1B1D1B7DAD144EEFAC714D779D97F5A7836DD366771D274FEA3D5C403329BA006BFED95056DD24E63D79750022C9A0BC6AA1557878102EDC97482BC10702E5F4DD40521FB0E63D40143304536B9EDCA35E631BDE56BE4048FC7DD1C40E831C0F449376F78692509248E518957CF285D3493E717EFC074D71F28814150000 , N'6.1.3-40302')
END

